# Use Node.js as the base image
FROM node:18

# Install OpenSSH Server
RUN apt-get update && apt-get install -y openssh-server

# Create a user and set password (for SSH)
RUN useradd -ms /bin/bash railwayuser
RUN echo "railwayuser:yourpassword" | chpasswd

# Expose ports for SSH (22) and WebSocket/HTTP (80)
EXPOSE 22
EXPOSE 80

# Set the working directory for your app
WORKDIR /app

# Copy package.json and install dependencies
COPY package.json /app/
RUN npm install

# Copy the rest of the application files
COPY . /app

# Start SSH server and your Node.js app (WebSocket/HTTP)
CMD service ssh start && node server.js
